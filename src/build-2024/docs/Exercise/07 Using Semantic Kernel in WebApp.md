# Exercise - Using Semantic Kernel in WebApp

## Create the web application

1. Run the following command on `PowerShell` to create a new .NET  web application named **HelloBuildMinimalWebAp**.

    ```shell
    dotnet new webapp -n HelloBuildMinimalWebAp
    ```

1. Switch to the newly created `HelloBuildMinimalWebAp` directory.

    ```shell
    cd 07 - Using Semantic Kernel in WebApp
    ```

1. Install Semantic Kernel nuget package

    ```shell
    dotnet add package Microsoft.SemanticKernel
    ```

1. Install Swashbuckle.AspNetCore nuget package

    ```shell
    dotnet add package Swashbuckle.AspNetCore
    ```

1. Open the project in VS Code or Visual Studio.

1. In the Program.cs file, delete all the existing code.

1. Add the following using statments at the top of `Program.cs` file.

    ```cshap
    using Microsoft.SemanticKernel;
    ```

1. Add model name and initialize web application builder

    ```csharp
    var openAIChatCompletionModelName = "gpt-4-turbo"; // this could be other models like "gpt-4o".
    var builder = WebApplication.CreateBuilder(args);
    ```

1. Add Kernel to web builder

    ```csharp
    builder.Services.AddKernel();
    ```

1. Add `AddOpenAIChatCompletion` service to the web builder and build the app

    ```csharp

    // This should work for any other service you can decided to use E.g Mistral.
    var kernel = builder.Services.AddOpenAIChatCompletion(openAIChatCompletionModelName, Environment.GetEnvironmentVariable("OPENAI_API_KEY"));
    var app = builder.Build();
    ```

1. Run the web app for returning `WeatherForecast` containing today’s data for a temperature with a short summary of the weather. The short summary of the weather is generated by AI by providing a prompt with a temperature.

    ```csharp

    app.MapGet("/WeatherForecast", async (Kernel kernel) =>
    {
        int temp = Random.Shared.Next(-20, 55);
        return new WeatherForecast
        (
            DateOnly.FromDateTime(DateTime.Now),
            temp,
            await kerel.InvokePromptAsync<string>($"Short description of weather at {temp} degrees Celsius") // This description will be generated by the AI model for the given temperature.
        );
    });
    app.Run();

    internal record WeatherForecast(DateOnly Date, int TempratureC, string Summary);
    ```

1. Run the application by entering `dotnet run` into the terminal You will get an output similar to the following

 ```comsole
 Building...
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://localhost:<your port>
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
info: Microsoft.Hosting.Lifetime[0]
      Content root path:<your path>
```

 1. Open your web browser and navigate to `http://localhost:<your-port>/WeatherForecast`, you will get json output similar to the following

    ```json
    {
        "date": "2024-06-17",
        "tempratureC": 4,
        "summary": "At 4 degrees Celsius, the weather is cool and slightly chilly. It is above freezing, so there is no ice, but it's cold enough that you might want a jacket or sweater when outdoors. This temperature is typical for late autumn or early spring in temperate regions."
    }
    ```

## Complete sample project

View the completed sample in the [07 Using Semantic Kernel in WebApp](../../07%20-%20Using%20Semantic%20Kernel%20in%20WebApp/)) project.

### Next unit: Summary

[Continue](../Summary.md)